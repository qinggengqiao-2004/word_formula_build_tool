开发者：Grok & Qiaoqinggeng

测试文件见压缩包：v2_release\v2_github\测试文档_v2.docx

图片见压缩包：v2_release\v2_github\README

该宏代码已在office for mac 2024，windows Microsoft Word 中测试。

***注意：请务必将word的公式编码调为Latex(图1) (也请检查AI生成是否生成Latex格式的公式）


1.对公式文本的准备：

要求AI将所有Latex源码，用’#!’字符、’#?’字符夹在中间
（可以修改为你喜欢的其他开始结束标记）

示例promt：（已在豆包AI中实测）
请帮我把上述内容重新输出一遍，注意在每段Latex内容的开头加入两个字符'#!'，末尾加入两个字符‘#?'。（因为在word中手动调整公式很麻烦，所以我写了一个程序可以定位这样的字符对，从而自动将word中的公式转为标准格式）


2.使用方法：

(1)在word搜索栏中输入‘宏’，选中‘宏’选项（图2）。

(2)进入页面后，随意取名新建一个宏（图3）。

(3)添加新宏后，office会自动进入VBA编辑页面（如果未进入，点击‘编辑’）（图4）。

(4)删除所有代码，将宏代码复制到VBA编辑器中，点击保存（或ctr+s）（图5）。

(5)切换到word窗口，搜索‘宏’，点击相同选项（图2），选中新加入的宏（宏名为Formulas_v2），点击‘运行’即可。


3.修改开始结束标记的方法：

在宏代码的第5、6行修改即可（图6）

代码片段：

startMark = "#!"  '如有需要请修改此处

endMark = "#?"   '如有需要请修改此处


